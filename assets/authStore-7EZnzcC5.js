import{c as d,s as u,p as c}from"./middleware-C6bdfTKr.js";import{c as i}from"./profileStore-nZaCuY-A.js";const g={BASE_URL:"https://19429ba06ff2.vps.myjino.ru/api",TIMEOUT:1e4,COMMANDID:"nikolai070797"},y=d()(u(c((r,l)=>({token:null,isLoading:!1,error:null,serverErrors:null,isHydrated:!1,setHydrated:s=>r({isHydrated:s}),setIsLoading:s=>r({isLoading:s}),handleError:(s,o)=>{var a;if(r({serverErrors:null}),i.isAxiosError(s)&&((a=s.response)!=null&&a.data)){const e=s.response.data;if(e.errors&&Array.isArray(e.errors)&&e.errors.length>0){const n=e.errors[0];r({serverErrors:e,error:n.message||o})}else{const t=e.code||e.message||o;r({error:t})}}else{const e=s instanceof Error?s.message:o;r({error:e})}},login:async({email:s,password:o})=>{const a={email:s,password:o};r({isLoading:!0,error:null});try{const e=await i.post("/signin",a),{token:n}=e.data;return r({token:n}),!0}catch(e){return l().handleError(e,"Ошибка входа"),r({isLoading:!1}),!1}finally{r({isLoading:!1})}},signup:async({email:s,password:o})=>{const a={email:s,password:o,commandId:g.COMMANDID};r({isLoading:!0,error:null});try{const e=await i.post("/signup",a),{token:n}=e.data;return r({token:n}),!0}catch(e){return l().handleError(e,"Ошибка регистрации"),r({isLoading:!1}),!1}finally{r({isLoading:!1})}},logout:()=>{r({token:null,isHydrated:!0,error:null,serverErrors:null,isLoading:!1})},clearStore:()=>{r({token:null,isLoading:!1,error:null,serverErrors:null,isHydrated:!0})},clearErrors:()=>{r({error:null,serverErrors:null})}}),{name:"auth-store",partialize:r=>({token:r.token,isHydrated:r.isHydrated})})));export{g as A,y as u};
