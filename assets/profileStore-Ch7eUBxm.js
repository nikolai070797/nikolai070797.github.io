import{a as l,c,s as p,p as f}from"./index-BgKIfoby.js";const n={getProfile:async()=>(await l.get("/profile")).data,updateProfile:async r=>(await l.put("/profile",r)).data,changePassword:async r=>await l.post("/profile/change-password",r)},g=c()(p(f((r,o)=>({profile:null,isLoading:!1,error:null,serverErrors:null,isUpdating:!1,updateSuccess:!1,handleError:(e,s)=>{var i;if(r({serverErrors:null}),l.isAxiosError(e)&&((i=e.response)!=null&&i.data)){const a=e.response.data;if(a.errors&&Array.isArray(a.errors)&&a.errors.length>0){const t=a.errors[0];r({serverErrors:a,error:t.message||s})}else{const u=a.code||a.message||s;r({error:u})}}else{const a=e instanceof Error?e.message:s;r({error:a})}},fetchProfile:async()=>{r({isLoading:!0,error:null,serverErrors:null});try{const e=await n.getProfile();return r({profile:e,isLoading:!1}),e}catch(e){return o().handleError(e,"Ошибка загрузки профиля"),r({isLoading:!1}),null}},updateProfile:async e=>{r({isUpdating:!0,error:null,serverErrors:null,updateSuccess:!1});try{const s=await n.updateProfile(e);return r({profile:s,isUpdating:!1,updateSuccess:!0}),s}catch(s){return o().handleError(s,"Ошибка обновления профиля"),r({isUpdating:!1}),null}},changePassword:async e=>{r({isUpdating:!0,error:null,serverErrors:null,updateSuccess:!1});try{return await n.changePassword(e),r({isUpdating:!1,updateSuccess:!0}),!0}catch(s){return o().handleError(s,"Ошибка смены пароля"),r({isUpdating:!1}),!1}},clearProfile:()=>{r({profile:null,error:null,serverErrors:null,updateSuccess:!1,isLoading:!1,isUpdating:!1})},clearErrors:()=>{r({error:null,serverErrors:null})}}),{name:"profile-store",partialize:r=>({profile:r.profile})}),{name:"profile-storage"}));export{g as u};
